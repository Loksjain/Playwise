# PlayWise GUI Makefile
# This Makefile builds the GUI version using Qt

# Compiler and flags
CXX = g++
CXXFLAGS = -std=c++17 -Wall -Wextra -O2

# Qt flags (adjust paths as needed for your Qt installation)
QT_INCLUDE = -I"C:/Qt/6.5.0/mingw_64/include" -I"C:/Qt/6.5.0/mingw_64/include/QtCore" -I"C:/Qt/6.5.0/mingw_64/include/QtWidgets" -I"C:/Qt/6.5.0/mingw_64/include/QtCharts"
QT_LIBS = -L"C:/Qt/6.5.0/mingw_64/lib" -lQt6Core -lQt6Widgets -lQt6Charts -lQt6Gui

# Alternative Qt5 paths (uncomment if using Qt5)
# QT_INCLUDE = -I"C:/Qt/5.15.2/mingw81_64/include" -I"C:/Qt/5.15.2/mingw81_64/include/QtCore" -I"C:/Qt/5.15.2/mingw81_64/include/QtWidgets" -I"C:/Qt/5.15.2/mingw81_64/include/QtCharts"
# QT_LIBS = -L"C:/Qt/5.15.2/mingw81_64/lib" -lQt5Core -lQt5Widgets -lQt5Charts -lQt5Gui

# Source files
CORE_SOURCES = song.cpp playlist_engine.cpp playback_history.cpp song_rating_tree.cpp song_lookup.cpp playlist_sorter.cpp system_snapshot.cpp
GUI_SOURCES = gui_main.cpp
CONSOLE_SOURCES = main.cpp

# Targets
all: playwise_gui.exe playwise_console.exe

# GUI version
playwise_gui.exe: $(GUI_SOURCES) $(CORE_SOURCES)
	$(CXX) $(CXXFLAGS) $(QT_INCLUDE) -o $@ $^ $(QT_LIBS) -mwindows

# Console version
playwise_console.exe: $(CONSOLE_SOURCES) $(CORE_SOURCES)
	$(CXX) $(CXXFLAGS) -o $@ $^

# Clean
clean:
	del /Q *.exe *.o *.moc

# Run GUI
run-gui: playwise_gui.exe
	./playwise_gui.exe

# Run Console
run-console: playwise_console.exe
	./playwise_console.exe

# Install Qt dependencies (Windows)
deploy-qt: playwise_gui.exe
	@echo "Deploying Qt dependencies..."
	@echo "Please run: windeployqt playwise_gui.exe"
	@echo "Make sure Qt is in your PATH or specify full path to windeployqt"

# Help
help:
	@echo "Available targets:"
	@echo "  all          - Build both GUI and console versions"
	@echo "  playwise_gui.exe - Build GUI version only"
	@echo "  playwise_console.exe - Build console version only"
	@echo "  clean        - Remove all build files"
	@echo "  run-gui      - Run GUI version"
	@echo "  run-console  - Run console version"
	@echo "  deploy-qt    - Deploy Qt dependencies (Windows)"
	@echo "  help         - Show this help"

.PHONY: all clean run-gui run-console deploy-qt help 